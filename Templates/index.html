{% extends "layout.html" %}

{% block body %}
    <div class="row">
        <div class="col-sm-4">
            <h1>
                To-Do List
            </h1>
                {# Adding tasks form #}
                <form action="{{ url_for('add_task') }}" method="post" class="add-entry">
                    <label for="name">Task Name:</label>
                        <input type="text" size="30" id="name" name="task_name" class="form-control">
                    <label for="date">Start date:</label>
                        <input class="form-control" type="date" id="date" name="task_date" value="2025-11-15" min="2025-11-15" max="2999-12-31">
                    <label for="category">Category:</label>
                        <input type="text" size="30" id="category" name="task_category" class="form-control">
                    <input hidden name="task_status" value=0>
                    <input hidden name="user_id" value="{{ user_id }}">
                    <input type="submit" value="Add" class="btn btn-primary">
                </form>

            {# filter tasks form #}
          <form action="{{ url_for('index') }}" method="post" class="filter-entries">
           <label for="category_dropdown">Category search:</label>
                <select name="category" id="category_dropdown" class="form-select">
                    <option name="category" value="">All Categories</option>
                    {% for cat in categories %}
                        {% if cat.task_category %}
                            <option name="category" value="{{ cat.task_category }}">{{ cat.task_category }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
               <input type="submit" value="Search" class="btn btn-success">
          </form>

            {# Display task name and task category #}
            <ul class="list-group">
                <li class="list-group-item">
                    <div class="row">
                        <div class="col-sm-6">
                            Task name
                        </div>
                        <div class="col-sm-6">
                            Task category
                        </div>
                    </div>
                </li>
            {# Display tasks along with their categories #}
                {%for i in task%}
                    <li class="list-group-item">
                        <div class="row">
                            <div class="col-sm-6">
                                {{ i.task_name }}
                            </div>
                            <div class="col-sm-2">
                                {{ i.task_category }}
                            </div>
                        </div>
                        <div class="row">
                            {# Complete and delete task buttons #}
                            <div class="col-sm-2">
                                <form action="{{ url_for('complete_task') }}" method="post" class="delete-entry">
                                    <input hidden name="taskid" value="{{ i.taskid }}">
                                    <input type="submit" value="Complete" class="btn btn-success">
                                </form>
                            </div>
                            <div class="col-sm-3">
                                <form action="{{ url_for('delete_task') }}" method="post" class="delete-entry">
                                    <input hidden name="taskid" value="{{ i.taskid }}">
                                    <input type="submit" value="Delete" class="btn btn-danger">
                                </form>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
        <div class="col-sm-8">
            <h1>
                Garden
            </h1>
            <div class="row">
                <p>Current water: {{ user_water }}</p>
            </div>
            {# Button waters the current plant if they have available water #}
            <form action = "{{ url_for("water_plant") }}" method="post">
                <input hidden name="user_id" value="{{ user_id }}">
                <input type="Submit" value="Water" class="btn btn-primary">
            </form>
            <script>
                    window.onload = function() {
                        let img = document.getElementById("plant_image");
                        {# Determines which plant to display #}
                        let plant_display = {{ plant }};
                        if (plant_display === 2) {
                            img.src = "{{url_for('static', filename='plant2.png')}}";
                        } else if (plant_display === 3) {
                            img.src = "{{url_for('static', filename='plant3.png')}}";
                        }
                    };
            </script>
            {# Show plant 1 as the default state #}
            <img src="{{url_for('static', filename='plant1.png')}}" id="plant_image">
            <div class="row">
                <p>Water to put plant in garden: {{ water_to_garden }}</p>
            </div>
        </div>
    </div>
{% endblock %}